local WindowBase = JRequire "Libs.WindowMgr.WindowBase"
local MStaff = JRequire "Dev.Staff.MStaff"
local WindowType = JRequire "Libs.WindowMgr.WindowType"
local SoundMgr = JRequire "Libs.Sound.SoundMgr"
local ScrollGrid = JRequire "Dev.Common.ScrollGrid"
local _M = Class(WindowBase)
local _P = {}
local _R = {}

local Default_Img = "yg_sx_002"
local Select_Img = "yg_sx_003"

local PageWidth = 735
local PageHeight = 1127
local ItemWidth = 180
local ItemHeight = 468
local SpaceX = 5
local SpaceY = -11
local PageNum = 12
local ColNum = 4

function _M:OnPopCreate( ... )
	self:OnCreate(...)
end

--事件派发
function _M:Dispatch(funcName, ...)
	local fun = _R[funcName]
	if fun ~= nil then 
		fun(self, ...)
	end
end

--界面构建
function _M:OnCreate(...)
	MStaff.LoadStaffsSortType() --加载员工排序方式(20180508又说不存本地因为营销新手教程)

	local moudle = self:CreateMoudle(self._RootNode, "M_Staff_UMain")
	self.mMoudle = moudle

	moudle:Get("SSJ").Text = Csv.Text("staff_had")
	self.GOU = moudle:Get("GOU")
	self.GOU.Activity = MStaff.gou
	local XZ = moudle:Get("XZ")
	XZ:AddOnButton(function ( ... )
		SoundMgr.Play(10001)
		if MStaff.gou == true then
			MStaff.gou = false
			self.GOU.Activity = false
		else
			MStaff.gou = true
			self.GOU.Activity = true
		end
		_P.CreateStaffList(self,true)
		end, nil, 0.9)

	self.mRawTableItems = {}
	self.mRawTableItems2 = {} -- 没有获得的员工
	_P.CreateStaffList(self,false)
	local TextTitle = moudle:Get("C_Text")
	TextTitle.Text = Csv.Text("staff_title")
	local TextStaffNum = moudle:Get("StaffNum")
	TextStaffNum.Text = Csv.Text("staff_num")
	moudle:Get("NumText").Text = tostring(MStaff.StaffNum)

	local BtnClose = moudle:Get("C_Back_Btn")
	BtnClose:AddOnButton(function ( ... )
		SoundMgr.Play(10002)
		self:Destroy()
		end, nil, 1.2)

	local BtnRule = moudle:Get("C_Full_Help_Btn")
	BtnRule:AddOnButton(function ( ... )
		SoundMgr.Play(10001)
		WindowMgr.Create("URuleTips",Define.SysId.Staff)
		end, nil, 1.2)

	--排序
	self.isSorts = false
	
	moudle:Get("Order").Text = Csv.Text("staff_order")
	for i = 1,5,1 do
		moudle:Get("ordertext"..i).Text = Csv.Text("staff_order_"..i) 
	end

	moudle:Get("order1"):AddOnButton(function()
		_P.ClickSortItem(self,MStaff.StaffsSort.default)
	end)
	moudle:Get("order2"):AddOnButton(function()
		_P.ClickSortItem(self,MStaff.StaffsSort.level)
	end)
	moudle:Get("order3"):AddOnButton(function()
		_P.ClickSortItem(self,MStaff.StaffsSort.attr)
	end)
	moudle:Get("order4"):AddOnButton(function()
		_P.ClickSortItem(self,MStaff.StaffsSort.apitude)
	end)
	moudle:Get("order5"):AddOnButton(function()
		_P.ClickSortItem(self,MStaff.StaffsSort.star)
	end)
end

function _R.ChangeStaffLv(self,staffid)
	local moudle = self.mStaffMoudleTable[staffid]
	local data = MStaff.GetStaffDataByID(staffid)
	if moudle ~= nil and data ~= nil then
		moudle:Get("Level").Text = data.level
	end
end

function _R.ChangeStaffColor(self,staffid)
	local moudle = self.mStaffMoudleTable[staffid]
	local data = MStaff.GetStaffDataByID(staffid)
	if moudle ~= nil and data ~= nil then
		moudle:Get("BG_2").SpriteName = MStaff.Color2Image[data.color]
	end
end

function _P.CreateStaffList(self,isForSort)
	for i = 1,5 do
		self.mMoudle:Get("order"..i).SpriteName = Default_Img
	end
	if MStaff.SortType ~= nil then
		self.mMoudle:Get("order"..(MStaff.SortType + 1)).SpriteName = Select_Img
	end

	local contentTransform = self.mMoudle:Get("Content")
	-- if not isForSort then
	-- 	contentTransform:DestroyChildren()

	-- 	local staffTableDatas = _P.GetSortStaffs(self,MStaff.StaffTable,MStaff.SortType)
	-- 	for k,v in ipairs(staffTableDatas) do
	-- 		self.mRawTableItems[v.id] = _P.OnCreateItem(v,contentTransform)
	-- 	end
	-- 	self.mSortStaffDatas = staffTableDatas

	-- 	staffTableDatas = _P.GetSortStaffsNotObtained(self,MStaff.StaffTable,MStaff.SortType)
	-- 	for k,v in ipairs(staffTableDatas) do
	-- 		self.mRawTableItems2[v.id] = _P.OnCreateItem(v,contentTransform)
	-- 		self.mRawTableItems2[v.id].moudle.SelfRect.Activity = not MStaff.gou
	-- 	end
	-- else
	-- 	local staffTableDatas = _P.GetSortStaffs(self,MStaff.StaffTable,MStaff.SortType)
	-- 	for k,v in ipairs(staffTableDatas) do
	-- 		local item = self.mRawTableItems[v.id]
	-- 		if item ~= nil then
	-- 			item.moudle.SelfRect.CachedTran:SetSiblingIndex(k - 1)
	-- 		end
	-- 	end

	-- 	local num = #staffTableDatas
	-- 	if Csv.Personnel ~= nil and MStaff.gou == false then
	-- 		staffTableDatas = _P.GetSortStaffsNotObtained(self,MStaff.StaffTable,MStaff.SortType)
	-- 		for k,v in ipairs(staffTableDatas) do
	-- 			local item = self.mRawTableItems2[v.id]
	-- 			if item ~= nil then
	-- 				item.moudle.SelfRect.CachedTran:SetSiblingIndex(num + k - 1)
	-- 				item.moudle.SelfRect.Activity = true
	-- 			end
	-- 		end
	-- 	else
	-- 		staffTableDatas = _P.GetSortStaffsNotObtained(self,MStaff.StaffTable,MStaff.SortType)
	-- 		for k,v in ipairs(staffTableDatas) do
	-- 			local item = self.mRawTableItems2[v.id]
	-- 			if item ~= nil then
	-- 				item.moudle.SelfRect.CachedTran:SetSiblingIndex(num + k - 1)
	-- 				item.moudle.SelfRect.Activity = false
	-- 			end
	-- 		end
	-- 	end
	-- end


	contentTransform:DestroyChildren()
	self.mStaffMoudleTable = {}
	local scroll = self.mMoudle:Get("scrollView")
	if self.scrollController ~= nil then
		self.scrollController:delete()
		self.scrollController = nil
	end
	local scrollController = ScrollGrid.new(scroll,contentTransform,"M_Staff_Item",
	function(index,value,moudle)_P.ScrollCallBack(self,index,value,moudle)end,
	function(index,value)_P.ScrollCallBack2(self,index,value)end
	)
	local list = _P.GetAllStaffData(self)
	self.mList = list
	scrollController:CreateScroll(PageNum,PageHeight,PageWidth,ItemHeight,SpaceY,list,ColNum)
	self.scrollController = scrollController
end

function _P.GetAllStaffData(self)
	local staffTableDatas
	if MStaff.gou then
		staffTableDatas = _P.GetSortStaffs(self,MStaff.StaffTable,MStaff.SortType)
	else
		staffTableDatas = _P.GetSortStaffsNotObtained(self,MStaff.StaffTable,MStaff.SortType)
	end
	local staffTable = {}
	for k,v in ipairs(staffTableDatas) do
		table.insert(staffTable,v)
	end
	return staffTable
end

function _P.ScrollCallBack2(self,index,data)
	if self.mStaffMoudleTable ~= nil then
		self.mStaffMoudleTable[data.id] = nil
	end
end

function _P.ScrollCallBack(self,index,data,itemMoudle)
	if MStaff.NoStaff(data.id) then
		itemMoudle:Get("BG_2").IsGray = true
		itemMoudle:Get("Icon").IsGray = true
	else
		itemMoudle:Get("BG_2").IsGray = false
		itemMoudle:Get("Icon").IsGray = false
	end
	local csvPerson = Csv.Personnel[data.id]

	local ImgIcon = itemMoudle:Get("Icon")
	ImgIcon.SpriteName = csvPerson.asset2
	
	itemMoudle:Get("BG_2").SpriteName = MStaff.Color2Image[data.color]

	itemMoudle:Get("BG_2"):AddOnButton(function ( ... )
		SoundMgr.Play(10001)
		_P.OnClickItem(data.id)
		end, nil, 1)

	local TextLevel = itemMoudle:Get("Level")
	TextLevel.Text = data.level

	local TextName = itemMoudle:Get("Name")
	TextName.Text = MStaff.GetStaffName(data.id)--csvPerson.name

	local ImgRedPoint = itemMoudle:Get("RedPoint")
	ImgRedPoint.Activity = MStaff.GetRedPointState(data.id)

	for i = 1,7 do
		local imgStar = itemMoudle:Get("Star"..i)
		if imgStar ~= nil then
			imgStar.Activity = false
		end
	end

	for i = 1,csvPerson.star do
		itemMoudle:Get("Star"..i).Activity = true
	end

	for i = 1,4 do
		local imgZizhi = itemMoudle:Get("Zizhi"..i)
		if imgZizhi ~= nil then
			imgZizhi.Activity = false
		end
	end

	for k,v in ipairs(csvPerson.specialtyIcon) do
		local imgZizhi = itemMoudle:Get("Zizhi"..k)
		if imgZizhi ~= nil then
			imgZizhi.Activity = true
			imgZizhi.SpriteName = v
		end
	end

	self.mStaffMoudleTable[data.id] = itemMoudle

	itemMoudle.SelfRect.LocalPosition = _P.GetPos(self,index)
end

function _P.GetPos(self,index)
	local num1,num2 = math.modf(index/ColNum)
	local col
	local row
	local x
	local y
	if num2 == 0 then
		col = ColNum
		row = num1
	else
		col = index%ColNum
		row = num1 + 1
	end
	x = col * (ItemWidth + SpaceX) - SpaceX - ItemWidth/2 - PageWidth/2
	local allNum = #self.mList
	local num3,num4 = math.modf(allNum/ColNum)
	local allColNum
	if num4 == 0 then
		allColNum = num3
	else
		allColNum = num3 + 1
	end
	y = ((ItemHeight + SpaceY) * allColNum - SpaceY)/2 - ((row - 1) * (ItemHeight + SpaceY) + ItemHeight/2)
	return Vector2(x,y)
end

function _P.ClickSortItem(self,sortType)
	--MStaff.SortType = sortType
	MStaff.SetStaffsSortType(sortType)
	_P.CreateStaffList(self,true)
end

function _P.GetSortStaffsNotObtained(self,sortType)
	local sortTable = {}
	for index, v in pairs(Csv.Personnel) do
		if MStaff.StaffTable[v.id] == nil then
			table.insert(sortTable,v)
		else
			table.insert(sortTable,MStaff.StaffTable[v.id])
		end
	end

	table.sort(sortTable,function(a,b)
		return a.id < b.id 
	end)

	local sortType = MStaff.SortType 
	--属性排序
	--按照属性(实力)》综合资质》品质》星数》id排序
	if sortType == MStaff.StaffsSort.attr then
		table.sort(sortTable,function(a,b)
			local isHaveA = MStaff.StaffTable[a.id] ~= nil
			local isHaveB = MStaff.StaffTable[b.id] ~= nil
			if isHaveA == isHaveB then
				local aAttr
				local bAttr
				if not isHaveA then
					aAttr = MStaff.GetAllAttrNotObtained(a.id)
					bAttr = MStaff.GetAllAttrNotObtained(b.id)
				else
					aAttr = MStaff.GetAllAttr(a.id)
					bAttr = MStaff.GetAllAttr(b.id)
				end
				if aAttr == bAttr then
					local aZiZhi
					local bZiZhi
					if not isHaveA then
						aZiZhi = MStaff.GetAllApitudeNotObtained(a.id)
						bZiZhi = MStaff.GetAllApitudeNotObtained(b.id)
					else
						aZiZhi = MStaff.GetAllApitude(a.id)
						bZiZhi = MStaff.GetAllApitude(b.id)
					end
					if aZiZhi == bZiZhi then
						if a.color == b.color then
							local aStar = Csv.Personnel[a.id].star
							local bStar = Csv.Personnel[b.id].star
							if aStar == bStar then
								return a.id < b.id
							else
								return aStar > bStar
							end
						else
							return a.color > b.color
						end
					else
						return aZiZhi > bZiZhi
					end
				else
					return aAttr > bAttr
				end
			elseif isHaveA then
				return true
			elseif isHaveB then
				return false
			end
		end)
		return sortTable
	--等级排序
	--按照等级》属性》综合资质》星数》id排序
	elseif sortType == MStaff.StaffsSort.level then
		table.sort(sortTable,function(a,b)
			local isHaveA = MStaff.StaffTable[a.id] ~= nil
			local isHaveB = MStaff.StaffTable[b.id] ~= nil
			if isHaveA == isHaveB then
				if not isHaveA then
					local aAttr = MStaff.GetAllAttrNotObtained(a.id)
					local bAttr = MStaff.GetAllAttrNotObtained(b.id)
					if aAttr == bAttr then
						local aZiZhi = MStaff.GetAllApitudeNotObtained(a.id)
						local bZiZhi = MStaff.GetAllApitudeNotObtained(b.id)
						if aZiZhi == bZiZhi then
							local aStar = Csv.Personnel[a.id].star
							local bStar = Csv.Personnel[b.id].star
							if aStar == bStar then
								return a.id < b.id
							else
								return aStar > bStar
							end
						else
							return aZiZhi > bZiZhi
						end
					else
						return aAttr > bAttr
					end
				else
					if a.level == b.level then
						local aAttr = MStaff.GetAllAttr(a.id)
						local bAttr = MStaff.GetAllAttr(b.id)
						if aAttr == bAttr then
							local aZiZhi = MStaff.GetAllApitude(a.id)
							local bZiZhi = MStaff.GetAllApitude(b.id)
							if aZiZhi == bZiZhi then
								local aStar = Csv.Personnel[a.id].star
								local bStar = Csv.Personnel[b.id].star
								if aStar == bStar then
									return a.id < b.id
								else
									return aStar > bStar
								end
							else
								return aZiZhi > bZiZhi
							end
						else
							return aAttr > bAttr
						end
					else
						return a.level > b.level
					end
				end
			elseif isHaveA then
				return true
			elseif isHaveB then
				return false
			end
		end)
		return sortTable
	--资质排序
	--按照综合资质》属性》品质》星数》id排序
	elseif sortType == MStaff.StaffsSort.apitude then
		table.sort(sortTable,function(a,b)
			local isHaveA = MStaff.StaffTable[a.id] ~= nil
			local isHaveB = MStaff.StaffTable[b.id] ~= nil
			if isHaveA == isHaveB then
				local aZiZhi
				local bZiZhi
				if not isHaveA then
					aZiZhi = MStaff.GetAllApitudeNotObtained(a.id)
					bZiZhi = MStaff.GetAllApitudeNotObtained(b.id)
				else
					aZiZhi = MStaff.GetAllApitude(a.id)
					bZiZhi = MStaff.GetAllApitude(b.id)
				end
				if aZiZhi == bZiZhi then
					local aAttr
					local bAttr
					if not isHaveA then
						aAttr = MStaff.GetAllAttrNotObtained(a.id)
						bAttr = MStaff.GetAllAttrNotObtained(b.id)
					else
						aAttr = MStaff.GetAllAttr(a.id)
						bAttr = MStaff.GetAllAttr(b.id)
					end
					if aAttr == bAttr then
						if a.color == b.color then
							local aStar = Csv.Personnel[a.id].star
							local bStar = Csv.Personnel[b.id].star
							if aStar == bStar then
								return a.id < b.id
							else
								return aStar > bStar
							end
						else
							return a.color > b.color
						end
					else
						return aAttr > bAttr
					end
					
				else
					return aZiZhi > bZiZhi
				end
			elseif isHaveA then
				return true
			elseif isHaveB then
				return false
			end
		end)
		return sortTable
	--星数排序
	--按照星级》属性》综合资质》品质》id排序
	elseif sortType == MStaff.StaffsSort.star then
		table.sort(sortTable,function(a,b)
			local isHaveA = MStaff.StaffTable[a.id] ~= nil
			local isHaveB = MStaff.StaffTable[b.id] ~= nil
			if isHaveA == isHaveB then
				local aStar = Csv.Personnel[a.id].star
				local bStar = Csv.Personnel[b.id].star
				if aStar == bStar then
					local aAttr
					local bAttr
					if not isHaveA then
						aAttr = MStaff.GetAllAttrNotObtained(a.id)
						bAttr = MStaff.GetAllAttrNotObtained(b.id)
					else
						aAttr = MStaff.GetAllAttr(a.id)
						bAttr = MStaff.GetAllAttr(b.id)
					end
					if aAttr == bAttr then
						local aZiZhi
						local bZiZhi
						if not isHaveA then
							aZiZhi = MStaff.GetAllApitudeNotObtained(a.id)
							bZiZhi = MStaff.GetAllApitudeNotObtained(b.id)
						else
							aZiZhi = MStaff.GetAllApitude(a.id)
							bZiZhi = MStaff.GetAllApitude(b.id)
						end
						if aZiZhi == bZiZhi then
							if a.color == b.color then
								return a.id < b.id
							else
								return a.color > b.color
							end
						else
							return aZiZhi > bZiZhi
						end
					else
						return aAttr > bAttr
					end
				else
					return aStar > bStar
				end
			elseif isHaveA then
				return true
			elseif isHaveB then
				return false
			end
		end)
		return sortTable
	else
		--id排序
		return sortTable
	end
end

function _P.GetSortStaffs(self,rawTable,sortType)
	local sortTable = {}
	for k,v in pairs(rawTable) do
		table.insert(sortTable,v)
	end

	table.sort(sortTable,function(a,b)
		return a.id < b.id 
	end)
	
	local sortType = MStaff.SortType 
	--属性排序
	--按照属性(实力)》综合资质》品质》星数》id排序
	if sortType == MStaff.StaffsSort.attr then
		table.sort(sortTable,function(a,b)
			local aAttr = MStaff.GetAllAttr(a.id)
			local bAttr = MStaff.GetAllAttr(b.id)
			if aAttr == bAttr then
				local aZiZhi = MStaff.GetAllApitude(a.id)
				local bZiZhi = MStaff.GetAllApitude(b.id)
				if aZiZhi == bZiZhi then
					if a.color == b.color then
						local aStar = Csv.Personnel[a.id].star
						local bStar = Csv.Personnel[b.id].star
						if aStar == bStar then
							return a.id < b.id
						else
							return aStar > bStar
						end
					else
						return a.color > b.color
					end
				else
					return aZiZhi > bZiZhi
				end
			else
				return aAttr > bAttr
			end
		end)
		return sortTable
	--等级排序
	--按照等级》属性》综合资质》星数》id排序
	elseif sortType == MStaff.StaffsSort.level then
		table.sort(sortTable,function(a,b)
			if a.level == b.level then
				local aAttr = MStaff.GetAllAttr(a.id)
				local bAttr = MStaff.GetAllAttr(b.id)
				if aAttr == bAttr then
					local aZiZhi = MStaff.GetAllApitude(a.id)
					local bZiZhi = MStaff.GetAllApitude(b.id)
					if aZiZhi == bZiZhi then
						local aStar = Csv.Personnel[a.id].star
						local bStar = Csv.Personnel[b.id].star
						if aStar == bStar then
							return a.id < b.id
						else
							return aStar > bStar
						end
					else
						return aZiZhi > bZiZhi
					end
				else
					return aAttr > bAttr
				end
			else
				return a.level > b.level
			end
		end)
		return sortTable
	--资质排序
	--按照综合资质》属性》品质》星数》id排序
	elseif sortType == MStaff.StaffsSort.apitude then
		table.sort(sortTable,function(a,b)
			local aZiZhi = MStaff.GetAllApitude(a.id)
			local bZiZhi = MStaff.GetAllApitude(b.id)
			if aZiZhi == bZiZhi then
				local aAttr = MStaff.GetAllAttr(a.id)
				local bAttr = MStaff.GetAllAttr(b.id)
				if aAttr == bAttr then
					if a.color == b.color then
						local aStar = Csv.Personnel[a.id].star
						local bStar = Csv.Personnel[b.id].star
						if aStar == bStar then
							return a.id < b.id
						else
							return aStar > bStar
						end
					else
						return a.color > b.color
					end
				else
					return aAttr > bAttr
				end
				
			else
				return aZiZhi > bZiZhi
			end
		end)
		return sortTable
	--星数排序
	--按照星级》属性》综合资质》品质》id排序
	elseif sortType == MStaff.StaffsSort.star then
		table.sort(sortTable,function(a,b)
			local aStar = Csv.Personnel[a.id].star
			local bStar = Csv.Personnel[b.id].star
			if aStar == bStar then
				local aAttr = MStaff.GetAllAttr(a.id)
				local bAttr = MStaff.GetAllAttr(b.id)
				if aAttr == bAttr then
					local aZiZhi = MStaff.GetAllApitude(a.id)
					local bZiZhi = MStaff.GetAllApitude(b.id)
					if aZiZhi == bZiZhi then
						if a.color == b.color then
							return a.id < b.id
						else
							return a.color > b.color
						end
					else
						return aZiZhi > bZiZhi
					end
				else
					return aAttr > bAttr
				end
			else
				return aStar > bStar
			end
		end)
		return sortTable
	else
		--id排序
		return sortTable
	end
end

function _P.OnCreateItem(data,contentTransform)
	local staff = {}
	local itemMoudle = JGuiManager.GetMoudle(contentTransform, "M_Staff_Item", WindowType.UI, 0)
	if MStaff.NoStaff(data.id) then
		itemMoudle:Get("BG_2").IsGray = true
		itemMoudle:Get("Icon").IsGray = true
	else
		itemMoudle:Get("BG_2").IsGray = false
		itemMoudle:Get("Icon").IsGray = false
	end
	local csvPerson = Csv.Personnel[data.id]

	local ImgIcon = itemMoudle:Get("Icon")
	ImgIcon.SpriteName = csvPerson.asset2
	--ImgIcon.LocalPosition = Vector2(csvPerson.headPos[1],csvPerson.headPos[2])

	itemMoudle:Get("BG_2").SpriteName = MStaff.Color2Image[data.color]

	itemMoudle:Get("BG_2"):AddOnButton(function ( ... )
		SoundMgr.Play(10001)
		_P.OnClickItem(data.id)
		end, nil, 1)

	local TextLevel = itemMoudle:Get("Level")
	TextLevel.Text = data.level

	local TextName = itemMoudle:Get("Name")
	TextName.Text = MStaff.GetStaffName(data.id)--csvPerson.name

	local ImgRedPoint = itemMoudle:Get("RedPoint")
	ImgRedPoint.Activity = MStaff.GetRedPointState(data.id)

	for i = 1,7 do
		local imgStar = itemMoudle:Get("Star"..i)
		if imgStar ~= nil then
			imgStar.Activity = false
		end
	end

	for i = 1,csvPerson.star do
		itemMoudle:Get("Star"..i).Activity = true
	end

	for i = 1,4 do
		local imgZizhi = itemMoudle:Get("Zizhi"..i)
		if imgZizhi ~= nil then
			imgZizhi.Activity = false
		end
	end

	for k,v in ipairs(csvPerson.specialtyIcon) do
		local imgZizhi = itemMoudle:Get("Zizhi"..k)
		if imgZizhi ~= nil then
			imgZizhi.Activity = true
			imgZizhi.SpriteName = v
		end
	end

	staff.moudle = itemMoudle

	return staff
end

function _P.OnClickItem(id)
	if id ~= nil then
		MStaff.LastChooseStaff = id
		if MStaff.NoStaff(id) then
			WindowMgr.Create("UStaffDetailsNotObtained",id)
		else
			WindowMgr.Create("UStaffDetails",id)
		end
	end
end

function _R.ResetPoint(self)
	local staffTable = MStaff.StaffTable
	for k,v in pairs(staffTable) do
		if v.id ~= nil then
			local moudle = self.mStaffMoudleTable[v.id]
			if moudle ~= nil then
				moudle:Get("RedPoint").Activity = MStaff.GetRedPointState(v.id)
			end
		end
	end
end

function _R.RefreshStaffName(self,id)
	local moudle = self.mStaffMoudleTable[id]
	if moudle ~= nil then
		local TextName = moudle:Get("Name")
		TextName.Text = MStaff.GetStaffName(id)
	end
end

function _M:BeforeDestroy()
	if self.scrollController ~= nil then
		self.scrollController:delete()
		self.scrollController = nil
	end
end

return _M